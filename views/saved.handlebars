
    
    <style>

        .article_row{
            font-family:sans-serif;
        }
        
        .content-div{
            margin-bottom: 50px;
        }

        .title-div{
            font-size: xx-large;
            background-color: #3882f2 ;
            color: #fefefe;
        }

        .content-div, a, span {
            
        }

        .add-note,.unsave-btn{
            line-height: 10px !important;
            margin-bottom: 5px;
            color: black
        }

    </style>


<h1>In Saved</h1>


<div id="divContent">
    
</div>

<div id="myModal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Notes</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <form>

            <div class="form-group">
                <label for="exampleInputNote">Note Content</label>
                <textarea class="form-control" id="exampleInputNote" rows="3" placeholder="Enter Note"></textarea>
            </div>

        </form>

      </div>
      <div class="modal-footer">
        <button id="saveChanges" type="button" class="btn btn-primary">Save changes</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


{{!-- Bootstrap JS --}}
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
{{!-- / Bootstrap JS --}}

{{!-- JQUERY --}}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

{{!-- JS Bootstrap --}}
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script>

    function displayScrappedDocuments(result){

        $("#divContent").empty();

        var data = result;
   

        for(var i = 0; i < data.length; i++){

            var row = $("<div>");
            
            $(row).addClass("row article_row");

            var colContent = $("<div>");
            var colButton = $("<div>");

            $(colContent).addClass("col-10 content-div");
            $(colButton).addClass("col-2 button-div");



            var rowContent = $("<div>");
            var rowButtons = $("<div>");
            
            
            $(rowContent).addClass("row");
            $(rowButtons).addClass("row");



            var articleTitle = $("<a>");          
            $(articleTitle).addClass("col-12 title-div");
            $(articleTitle).text(data[i].title);
            $(articleTitle).attr("href", data[i].link);



            var articleSummary = $("<span>");         
            $(articleSummary).addClass("col-12 summary-div");           
            $(articleSummary).text(data[i].summary);

            
            $(rowContent).append(articleTitle);
            $(rowContent).append(articleSummary);
            $(colContent).append(rowContent);
            


            var note = $("<a>");
            $(note).addClass("btn btn-light col-12 btn-lg add-note");
            $(note).attr("type","button");
            $(note).text("NOTE");
            $(note).attr("obj_id",data[i]._id);


            var unsaveArticle = $("<a>");
            $(unsaveArticle).addClass("btn btn-light col-12 btn-lg unsave-btn");
            $(unsaveArticle).attr("type","button");
            $(unsaveArticle).text("UNSAVE");
            $(unsaveArticle).attr("obj_id", data[i]._id);
            $(unsaveArticle).attr("saved_id", data[i].saved);


            $(rowButtons).append(unsaveArticle);
            $(rowButtons).append(note);
            $(colButton).append(rowButtons);


            $(row).append(colContent);
            $(row).append(colButton);

            
            $("#divContent").append(row);

        }
     
        // location.reload();

    }


    function noScrappedDocuments(){

        var row = $("<div>");
        
        $(row).addClass("row");

        var div = $("<div>");
        
        $(div).addClass("col-12");

        $(div).attr("id","noArticlesDisplay");

        $(div).text("Uh Oh. Looks like we don't have any new articles");


        $(row).append(div);
        $("#divContent").append(row);

    }


    function getArticles(){


        var urlPath = "/savedarticle";
        var ajaxType = "GET";

        $.ajax({
            url: urlPath,
            type: ajaxType,
            success: function(response){

                if(response.length > 0){
                    displayScrappedDocuments(response);
                }
                else{
                    noScrappedDocuments();
                }
            }
        });
        
    };


    function removeSavedArticle(obj){


        var removeObj = obj;
        var urlPath = "/removeSaved";
        var apiType  = "DELETE";

        $.ajax({
            url: urlPath,
            type: apiType,
            data: removeObj,
            success: function(result){

                location.reload();

            }
        });

    }


    function getNote(articleId){
        
        var obj = {};

        obj.id = articleId;

        var urlPath = "/getNote";
        var apiType  = "GET";

        $.ajax({
            url: urlPath,
            type: apiType,
            data: obj,
            success: function(result){


                console.log(result);

                $('#myModal').modal('show');
                                
            }
        });        
    };


    function addNote(noteObj){
        
        var obj = noteObj;
        var urlPath = "/addNote";
        var apiType  = "POST";

        $.ajax({
            url: urlPath,
            type: apiType,
            data: obj,
            success: function(result){
               

                $('#myModal').modal('hide');
                
            }
        });
    }


    function removeNote(obj){
        var removeObj = obj;
        var urlPath = "/removeNote";
        var apiType  = "DELETE";

        $.ajax({
            url: urlPath,
            type: apiType,
            data: removeObj,
            success: function(result){
                
                
            }
        });
    }


    $(document).on("click", "#saveChanges", function(event){
        
        event.preventDefault();

        var newNote = $("#exampleInputNote").val();

        var articleId = $("#saveChanges").attr("articleId");

        var obj = {};

        obj.articleId = articleId;
        obj.newNote = newNote;

        console.log(obj);

        addNote(obj);

     

    });


    $(document).on("click",".add-note", function(event){
        event.preventDefault();

        var currentBtn = $(this); 

        var articleId = $(currentBtn).attr("obj_id");

        $("#saveChanges").attr("articleId", articleId);

        $('#myModal').modal('show');
        
        getNote(articleId);
        //addNote(articleId);
        
    });


    $(document).on("click",".delete-note", function(event){
        event.preventDefault();

        var currentBtn = $(this);

        removeNote();
    });


    $(document).on("click",".unsave-btn", function(event){


        event.preventDefault();

        var currentBtn = $(this);

        var articleId = $(currentBtn).attr("obj_id");

        var savedId = $(currentBtn).attr("saved_id");

        var obj = {};

        obj.articleId = articleId;
        obj.savedId = savedId;

        removeSavedArticle(obj);

    });


    $(document).ready(function(){
        getArticles();
    });


</script>